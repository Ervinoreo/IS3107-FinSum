[2025-04-23T03:09:05.020+0800] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-04-23T03:09:05.024+0800] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: reddit_yf_scraper.get_tickers scheduled__2025-04-21T19:00:00+00:00 [queued]>
[2025-04-23T03:09:05.027+0800] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: reddit_yf_scraper.get_tickers scheduled__2025-04-21T19:00:00+00:00 [queued]>
[2025-04-23T03:09:05.027+0800] {taskinstance.py:2867} INFO - Starting attempt 1 of 2
[2025-04-23T03:09:05.032+0800] {taskinstance.py:2890} INFO - Executing <Task(_PythonDecoratedOperator): get_tickers> on 2025-04-21 19:00:00+00:00
[2025-04-23T03:09:05.036+0800] {standard_task_runner.py:72} INFO - Started process 23880 to run task
[2025-04-23T03:09:05.039+0800] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'reddit_yf_scraper', 'get_tickers', 'scheduled__2025-04-21T19:00:00+00:00', '--job-id', '887', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/var/folders/2f/rw5w89ss6nl38qvq2cxrh29w0000gn/T/tmp7jqdjant']
[2025-04-23T03:09:05.040+0800] {standard_task_runner.py:105} INFO - Job 887: Subtask get_tickers
[2025-04-23T03:09:05.067+0800] {task_command.py:467} INFO - Running <TaskInstance: reddit_yf_scraper.get_tickers scheduled__2025-04-21T19:00:00+00:00 [running]> on host yueyaos-macbook-pro.local
[2025-04-23T03:09:05.095+0800] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='reddit_yf_scraper' AIRFLOW_CTX_TASK_ID='get_tickers' AIRFLOW_CTX_EXECUTION_DATE='2025-04-21T19:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-04-21T19:00:00+00:00'
[2025-04-23T03:09:05.096+0800] {logging_mixin.py:190} INFO - Task instance is in running state
[2025-04-23T03:09:05.096+0800] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2025-04-23T03:09:05.096+0800] {logging_mixin.py:190} INFO - Current task name:get_tickers state:running start_date:2025-04-22 19:09:05.024866+00:00
[2025-04-23T03:09:05.096+0800] {logging_mixin.py:190} INFO - Dag name:reddit_yf_scraper and current dag run status:running
[2025-04-23T03:09:05.096+0800] {taskinstance.py:732} INFO - ::endgroup::
[2025-04-23T03:09:06.378+0800] {logging_mixin.py:190} WARNING - /Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/table.py:1933 UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.
[2025-04-23T03:26:20.623+0800] {job.py:229} INFO - Heartbeat recovered after 1035.63 seconds
[2025-04-23T03:42:16.199+0800] {job.py:229} INFO - Heartbeat recovered after 955.58 seconds
[2025-04-23T03:59:26.814+0800] {job.py:229} INFO - Heartbeat recovered after 1030.62 seconds
[2025-04-23T04:16:44.417+0800] {job.py:229} INFO - Heartbeat recovered after 1037.61 seconds
[2025-04-23T04:28:00.038+0800] {job.py:229} INFO - Heartbeat recovered after 675.62 seconds
[2025-04-23T04:46:08.791+0800] {job.py:229} INFO - Heartbeat recovered after 1058.50 seconds
[2025-04-23T05:02:04.434+0800] {job.py:229} INFO - Heartbeat recovered after 955.64 seconds
[2025-04-23T05:18:23.037+0800] {job.py:229} INFO - Heartbeat recovered after 978.61 seconds
[2025-04-23T05:35:39.696+0800] {job.py:229} INFO - Heartbeat recovered after 1036.66 seconds
[2025-04-23T05:54:38.866+0800] {job.py:229} INFO - Heartbeat recovered after 962.86 seconds
[2025-04-23T06:10:57.474+0800] {job.py:229} INFO - Heartbeat recovered after 978.61 seconds
[2025-04-23T06:28:32.085+0800] {job.py:229} INFO - Heartbeat recovered after 1054.61 seconds
[2025-04-23T06:43:39.692+0800] {job.py:229} INFO - Heartbeat recovered after 907.61 seconds
[2025-04-23T06:59:49.317+0800] {job.py:229} INFO - Heartbeat recovered after 969.63 seconds
[2025-04-23T07:15:34.879+0800] {job.py:229} INFO - Heartbeat recovered after 945.57 seconds
[2025-04-23T07:29:30.451+0800] {job.py:229} INFO - Heartbeat recovered after 835.57 seconds
[2025-04-23T07:46:20.064+0800] {job.py:229} INFO - Heartbeat recovered after 1004.60 seconds
[2025-04-23T08:03:48.758+0800] {job.py:229} INFO - Heartbeat recovered after 1048.70 seconds
[2025-04-23T08:20:48.389+0800] {job.py:229} INFO - Heartbeat recovered after 1019.63 seconds
[2025-04-23T08:21:48.264+0800] {job.py:229} INFO - Heartbeat recovered after 34.73 seconds
[2025-04-23T08:30:32.496+0800] {job.py:229} INFO - Heartbeat recovered after 519.21 seconds
[2025-04-23T08:46:47.404+0800] {job.py:229} INFO - Heartbeat recovered after 974.91 seconds
[2025-04-23T08:50:41.397+0800] {job.py:229} INFO - Heartbeat recovered after 234.14 seconds
[2025-04-23T09:07:10.881+0800] {job.py:229} INFO - Heartbeat recovered after 984.47 seconds
[2025-04-23T09:23:30.489+0800] {job.py:229} INFO - Heartbeat recovered after 979.61 seconds
[2025-04-23T09:27:17.799+0800] {job.py:229} INFO - Heartbeat recovered after 51.05 seconds
[2025-04-23T09:31:34.270+0800] {job.py:229} INFO - Heartbeat recovered after 246.40 seconds
[2025-04-23T09:49:17.808+0800] {job.py:229} INFO - Heartbeat recovered after 1063.54 seconds
[2025-04-23T10:05:11.404+0800] {job.py:229} INFO - Heartbeat recovered after 953.60 seconds
[2025-04-23T10:20:44.989+0800] {job.py:229} INFO - Heartbeat recovered after 933.59 seconds
[2025-04-23T10:32:33.849+0800] {job.py:229} INFO - Heartbeat recovered after 678.66 seconds
[2025-04-23T10:49:28.318+0800] {job.py:229} INFO - Heartbeat recovered after 1014.47 seconds
[2025-04-23T11:06:29.913+0800] {job.py:229} INFO - Heartbeat recovered after 1021.60 seconds
[2025-04-23T11:24:25.523+0800] {job.py:229} INFO - Heartbeat recovered after 1075.61 seconds
[2025-04-23T11:33:34.750+0800] {job.py:229} INFO - Heartbeat recovered after 367.88 seconds
[2025-04-23T11:49:36.218+0800] {job.py:229} INFO - Heartbeat recovered after 961.47 seconds
[2025-04-23T11:49:50.502+0800] {job.py:229} INFO - Heartbeat recovered after 14.29 seconds
[2025-04-23T12:05:36.475+0800] {job.py:229} INFO - Heartbeat recovered after 940.93 seconds
[2025-04-23T12:21:01.140+0800] {job.py:229} INFO - Heartbeat recovered after 924.67 seconds
[2025-04-23T12:34:31.612+0800] {job.py:229} INFO - Heartbeat recovered after 776.56 seconds
[2025-04-23T12:50:37.107+0800] {job.py:229} INFO - Heartbeat recovered after 960.48 seconds
[2025-04-23T13:06:47.751+0800] {job.py:229} INFO - Heartbeat recovered after 970.65 seconds
[2025-04-23T13:22:42.965+0800] {job.py:229} INFO - Heartbeat recovered after 945.61 seconds
[2025-04-23T13:35:30.339+0800] {job.py:229} INFO - Heartbeat recovered after 591.00 seconds
[2025-04-23T13:52:59.761+0800] {job.py:229} INFO - Heartbeat recovered after 1044.40 seconds
[2025-04-23T14:09:26.036+0800] {job.py:229} INFO - Heartbeat recovered after 986.28 seconds
[2025-04-23T14:24:36.677+0800] {job.py:229} INFO - Heartbeat recovered after 910.64 seconds
[2025-04-23T14:36:31.368+0800] {job.py:229} INFO - Heartbeat recovered after 714.69 seconds
[2025-04-23T14:52:46.857+0800] {job.py:229} INFO - Heartbeat recovered after 970.46 seconds
[2025-04-23T15:08:30.558+0800] {job.py:229} INFO - Heartbeat recovered after 943.71 seconds
[2025-04-23T15:25:05.113+0800] {job.py:229} INFO - Heartbeat recovered after 994.56 seconds
[2025-04-23T15:37:32.688+0800] {job.py:229} INFO - Heartbeat recovered after 747.58 seconds
[2025-04-23T15:56:47.711+0800] {job.py:229} INFO - Heartbeat recovered after 978.83 seconds
[2025-04-23T16:12:10.344+0800] {job.py:229} INFO - Heartbeat recovered after 922.64 seconds
[2025-04-23T16:29:00.935+0800] {job.py:229} INFO - Heartbeat recovered after 1010.59 seconds
[2025-04-23T16:38:30.530+0800] {job.py:229} INFO - Heartbeat recovered after 569.60 seconds
[2025-04-23T16:55:13.069+0800] {job.py:229} INFO - Heartbeat recovered after 997.49 seconds
[2025-04-23T17:03:43.646+0800] {job.py:229} INFO - Heartbeat recovered after 510.58 seconds
[2025-04-23T17:19:31.569+0800] {job.py:229} INFO - Heartbeat recovered after 922.73 seconds
[2025-04-23T17:35:59.278+0800] {job.py:229} INFO - Heartbeat recovered after 987.71 seconds
[2025-04-23T17:39:34.945+0800] {job.py:229} INFO - Heartbeat recovered after 210.62 seconds
[2025-04-23T17:55:48.529+0800] {job.py:229} INFO - Heartbeat recovered after 968.55 seconds
[2025-04-23T18:12:19.167+0800] {job.py:229} INFO - Heartbeat recovered after 990.64 seconds
[2025-04-23T18:32:26.382+0800] {job.py:229} INFO - Heartbeat recovered after 1030.88 seconds
[2025-04-23T18:40:31.926+0800] {job.py:229} INFO - Heartbeat recovered after 485.55 seconds
[2025-04-23T18:40:55.912+0800] {job.py:229} INFO - Heartbeat recovered after 18.93 seconds
[2025-04-23T18:57:04.830+0800] {job.py:229} INFO - Heartbeat recovered after 968.92 seconds
[2025-04-23T19:12:59.490+0800] {job.py:229} INFO - Heartbeat recovered after 954.66 seconds
[2025-04-23T19:28:25.076+0800] {job.py:229} INFO - Heartbeat recovered after 925.59 seconds
[2025-04-23T19:37:33.029+0800] {job.py:229} INFO - Heartbeat recovered after 547.96 seconds
[2025-04-23T19:38:18.372+0800] {local_task_job_runner.py:346} WARNING - State of this instance has been externally set to None. Terminating instance.
[2025-04-23T19:38:18.374+0800] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-04-23T19:38:18.380+0800] {process_utils.py:132} INFO - Sending 15 to group 23880. PIDs of all processes in the group: [23880]
[2025-04-23T19:38:18.380+0800] {process_utils.py:87} INFO - Sending the signal 15 to group 23880
[2025-04-23T19:38:18.382+0800] {taskinstance.py:3094} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-04-23T19:38:18.405+0800] {taskinstance.py:3095} ERROR - Stacktrace: 
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/bin/airflow", line 8, in <module>
    sys.exit(main())
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/__main__.py", line 62, in main
    args.func(args)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/cli/commands/task_command.py", line 254, in _run_task_by_selected_method
    return _run_task_by_local_task_job(args, ti)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/cli/commands/task_command.py", line 322, in _run_task_by_local_task_job
    ret = run_job(job=job_runner.job, execute_callable=job_runner._execute)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/jobs/job.py", line 421, in run_job
    return execute_job(job, execute_callable=execute_callable)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/jobs/job.py", line 450, in execute_job
    ret = execute_callable()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/jobs/local_task_job_runner.py", line 171, in _execute
    self.task_runner.start()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/task/task_runner/standard_task_runner.py", line 55, in start
    self.process = self._start_by_fork()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 3006, in _run_raw_task
    return _run_raw_task(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 274, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 3161, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 3185, in _execute_task
    return _execute_task(self, context, task_orig)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 768, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 734, in _execute_callable
    return ExecutionCallableRunner(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/decorators/base.py", line 266, in execute
    return_value = super().execute(context)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/airflow/dags/dag.py", line 111, in get_tickers
    return load_sp500_tickers()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/airflow/dags/load_tickers.py", line 31, in load_sp500_tickers
    df = client.query(query).to_dataframe()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/job/query.py", line 2060, in to_dataframe
    return query_result.to_dataframe(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/table.py", line 2621, in to_dataframe
    record_batch = self.to_arrow(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/table.py", line 2170, in to_arrow
    for record_batch in self.to_arrow_iterable(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/table.py", line 2015, in _to_page_iterable
    yield from result_pages
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 788, in download_arrow_row_iterator
    for page in pages:
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/api_core/page_iterator.py", line 244, in _page_iter
    page = self._next_page()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/api_core/page_iterator.py", line 373, in _next_page
    response = self._get_next_page_response()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/table.py", line 1969, in _get_next_page_response
    return self.api_request(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/client.py", line 845, in _call_api
    return call()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/_http/__init__.py", line 482, in api_request
    response = self._make_request(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/_http/__init__.py", line 341, in _make_request
    return self._do_request(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/_http/__init__.py", line 379, in _do_request
    return self.http.request(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/auth/transport/requests.py", line 537, in request
    response = super(AuthorizedSession, self).request(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/Users/yueyaoz/.pyenv/versions/3.10.13/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/Users/yueyaoz/.pyenv/versions/3.10.13/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/Users/yueyaoz/.pyenv/versions/3.10.13/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/Users/yueyaoz/.pyenv/versions/3.10.13/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/Users/yueyaoz/.pyenv/versions/3.10.13/lib/python3.10/ssl.py", line 1307, in recv_into
    return self.read(nbytes, buffer)
  File "/Users/yueyaoz/.pyenv/versions/3.10.13/lib/python3.10/ssl.py", line 1163, in read
    return self._sslobj.read(len, buffer)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 3095, in signal_handler
    self.log.error("Stacktrace: \n%s", "".join(traceback.format_stack()))

[2025-04-23T19:38:18.423+0800] {taskinstance.py:3313} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 768, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 734, in _execute_callable
    return ExecutionCallableRunner(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/decorators/base.py", line 266, in execute
    return_value = super().execute(context)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/airflow/dags/dag.py", line 111, in get_tickers
    return load_sp500_tickers()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/airflow/dags/load_tickers.py", line 31, in load_sp500_tickers
    df = client.query(query).to_dataframe()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/job/query.py", line 2060, in to_dataframe
    return query_result.to_dataframe(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/table.py", line 2621, in to_dataframe
    record_batch = self.to_arrow(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/table.py", line 2170, in to_arrow
    for record_batch in self.to_arrow_iterable(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/table.py", line 2015, in _to_page_iterable
    yield from result_pages
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 788, in download_arrow_row_iterator
    for page in pages:
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/api_core/page_iterator.py", line 244, in _page_iter
    page = self._next_page()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/api_core/page_iterator.py", line 373, in _next_page
    response = self._get_next_page_response()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/table.py", line 1969, in _get_next_page_response
    return self.api_request(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/bigquery/client.py", line 845, in _call_api
    return call()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/_http/__init__.py", line 482, in api_request
    response = self._make_request(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/_http/__init__.py", line 341, in _make_request
    return self._do_request(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/cloud/_http/__init__.py", line 379, in _do_request
    return self.http.request(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/google/auth/transport/requests.py", line 537, in request
    response = super(AuthorizedSession, self).request(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/Users/yueyaoz/.pyenv/versions/3.10.13/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/Users/yueyaoz/.pyenv/versions/3.10.13/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/Users/yueyaoz/.pyenv/versions/3.10.13/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/Users/yueyaoz/.pyenv/versions/3.10.13/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/Users/yueyaoz/.pyenv/versions/3.10.13/lib/python3.10/ssl.py", line 1307, in recv_into
    return self.read(nbytes, buffer)
  File "/Users/yueyaoz/.pyenv/versions/3.10.13/lib/python3.10/ssl.py", line 1163, in read
    return self._sslobj.read(len, buffer)
  File "/Users/yueyaoz/Downloads/IS3107-FinSum/.airflow/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 3097, in signal_handler
    raise AirflowTaskTerminated("Task received SIGTERM signal")
airflow.exceptions.AirflowTaskTerminated: Task received SIGTERM signal
[2025-04-23T19:38:18.427+0800] {logging_mixin.py:190} INFO - Task instance in failure state
[2025-04-23T19:38:18.427+0800] {logging_mixin.py:190} INFO - Task start:2025-04-22 19:09:05.024866+00:00 end:2025-04-23 11:38:18.425999+00:00 duration:59353.401133
[2025-04-23T19:38:18.427+0800] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): get_tickers> dag:<DAG: reddit_yf_scraper> dagrun:<DagRun reddit_yf_scraper @ 2025-04-21 19:00:00+00:00: scheduled__2025-04-21T19:00:00+00:00, state:running, queued_at: 2025-04-22 19:09:02.807640+00:00. externally triggered: False>
[2025-04-23T19:38:18.427+0800] {logging_mixin.py:190} INFO - Failure caused by Task received SIGTERM signal
[2025-04-23T19:38:18.428+0800] {taskinstance.py:1226} INFO - Marking task as UP_FOR_RETRY. dag_id=reddit_yf_scraper, task_id=get_tickers, run_id=scheduled__2025-04-21T19:00:00+00:00, execution_date=20250421T190000, start_date=20250422T190905, end_date=20250423T113818
[2025-04-23T19:38:18.437+0800] {taskinstance.py:341} INFO - ::group::Post task execution logs
[2025-04-23T19:38:18.484+0800] {process_utils.py:80} INFO - Process psutil.Process(pid=23880, status='terminated', exitcode=2, started='03:09:05') (23880) terminated with exit code 2
